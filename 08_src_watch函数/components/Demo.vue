<template>
  <h1>Demo ç»„ä»¶ï¼šæ±‚å’Œ</h1>
  <h2>å½“å‰æ±‚å’Œä¸ºï¼š{{sum}}</h2>
  <button @click="sum++">ç‚¹å‡»++âš”ï¸âš”ï¸âš”ï¸</button>
  <hr>
  <h2>å½“å‰çš„ä¿¡æ¯ä¸ºï¼š{{msg}}</h2>
  <button @click="msg+='ğŸ¤¡'">ç‚¹å‡»æ·»åŠ å°ä¸‘</button>
  <hr>
  <h2>åï¼š{{person.name}}</h2>
  <h2>å¹´é¾„ï¼š{{person.age}}</h2>
  <button @click="person.name+='ğŸ‘¹'">ç‚¹å‡»æ”¹åå­—</button>
  <button @click="person.age++">ç‚¹å‡»æ”¹å¹´é¾„</button>
</template>

<script>
import { ref, watch, reactive } from 'vue'
export default {
  name: 'Demo',
  setup() {
    // æ•°æ®
    let sum = ref(0)
    let msg = ref('ä½ å¥½å•ŠğŸŸğŸ”ğŸ³')
    const person = reactive({ name: 'ææ˜Ÿäº‘', age: 19 })

    // ç›‘è§†
    //#region 
    // æƒ…å†µ 1ï¼šç›‘è§† ref å®šä¹‰çš„ 1 ä¸ªå“åº”å¼æ•°æ®
    /* watch(sum, (newVal, oldVal) => {
        console.log(`sumå‘ç”Ÿå˜åŒ–äº†ï¼Œ${newVal}ï¼Œ${oldVal}`);
    }) */
    //#endregion

    //#region 
    // æƒ…å†µ 2ï¼šç›‘è§† ref å®šä¹‰çš„ å¤š ä¸ªå“åº”å¼æ•°æ®ï¼ŒåŒæ—¶å†™å¤šä¸ª watchï¼Œè¿™ä¸ªæ˜¯ Vue2 ä¸æ”¯æŒçš„
    /* watch(sum, (newVal, oldVal) => {
        console.log(`sumå‘ç”Ÿå˜åŒ–äº†ï¼Œ${newVal}ï¼Œ${oldVal}`);
    })
    watch(msg, (newVal, oldVal) => {
        console.log(`msgå‘ç”Ÿå˜åŒ–äº†ï¼Œ${newVal}ï¼Œ${oldVal}`);
    }) */
    

    /* 
        ç›´æ¥å†™åœ¨ä¸€ä¸ª watch ä¸­
    */
    /* watch([sum, msg], (newVal, oldVal) => {
        // console.log(`sum æˆ– msg å‘ç”Ÿå˜åŒ–äº†ï¼Œ${newVal}ï¼Œ${oldVal}`);
        console.log(newVal, oldVal);
    }) */

    /* 
        æ·»åŠ  immediate å±æ€§ çš„å†™æ³•
    */
   /* watch([sum, msg], (newVal, oldVal) => {
        // console.log(`sum æˆ– msg å‘ç”Ÿå˜åŒ–äº†ï¼Œ${newVal}ï¼Œ${oldVal}`);
        console.log(newVal, oldVal);
    }, { immediate: true }) */
    //#endregion

    //#region 
    /* 
        æƒ…å†µ 3ï¼šç›‘è§† reactive æ‰€å®šä¹‰çš„ä¸€ä¸ªå“åº”å¼æ•°æ®çš„å…¨éƒ¨æ•°æ®
            æ³¨æ„ï¼š
                ã€1ã€‘æ­¤å¤„æ— æ³•è·å–æ­£ç¡®çš„ oldVal
                ã€2ã€‘å¼ºåˆ¶å¼€å¯äº†æ·±åº¦ç›‘è§†(deep é…ç½®æ— æ•ˆ)
    */
    /* watch(person, (nVal, oVal) => {
        // console.log(`sumå‘ç”Ÿå˜åŒ–äº†ï¼Œ${nVal}ï¼Œ${oVal}`);
        console.log('person å‘ç”Ÿå˜åŒ–äº†', nVal, oVal, nVal === oVal);
    }, { immediate: true }) */
    //#endregion
    

    /* 
        æƒ…å†µ 4ï¼šç›‘è§† reactive æ‰€å®šä¹‰çš„ä¸€ä¸ªå“åº”å¼æ•°æ®çš„æŸä¸ªæ•°æ®
    */
    
    watch(() => person.name, (nVal, oVal) => {
        console.log('person çš„ name å‘ç”Ÿå˜åŒ–äº†', nVal, oVal, nVal === oVal);
    }, { immediate: true })


    /* 
        æƒ…å†µ 5ï¼šç›‘è§† reactive æ‰€å®šä¹‰çš„ä¸€ä¸ªå“åº”å¼æ•°æ®çš„ä¸€äº›æ•°æ®
    */
    watch([() => person.name, () => person.age], (nVal, oVal) => {
            console.log('person çš„ name å‘ç”Ÿå˜åŒ–äº†', nVal, oVal, nVal === oVal);
        }, { immediate: true })



    return {
      sum,
      msg,
      person
    }  

  },
}
</script>

<style>
#app {
  font-family: Avenir, Helvetica, Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-align: center;
  color: #2c3e50;
  margin-top: 60px;
}
</style>
